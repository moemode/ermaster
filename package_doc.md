# Package Overview

| Module | Purpose |
| --- | --- |
| [erllm](#package-erllm) | Root package. Contains installation, documentation generation and helper code. |
| [erllm.calibration](#package-erllmcalibration) | Calibration analysis on entity matching LLM predictions. |
| [erllm.dataset](#package-erllmdataset) | Covers entity representation, dataset loading, downsampling.  The "DBpedia" submodule handles loading raw DBpedia data into subsampled CSV files, reading the raw data into SQLite database, interacting with it and generating labeled  datasets of matching and non-matching DBpedia entity pairs for benchmarking. |
| [erllm.dataset.dbpedia](#package-erllmdatasetdbpedia) | Handles DBPedia data including loading raw data into SQLite,  interaction, and generation of labeled datasets using token blocking for benchmarking. |
| [erllm.dataset.ditto](#package-erllmdatasetditto) | Convert existing datasets to DITTO format. |
| [erllm.discarder](#package-erllmdiscarder) | Explores the similarity-based discarder in isolation.  Computes and saves set-based and embedding-based similarities for pairs of entities,  Includes functionality to save results and computation time into similarity files, compute various discarder statistics, and generate visualizations. |
| [erllm.discarding_matcher](#package-erllmdiscarding_matcher) | Simulates and evaluates a similarity-based discarding matcher. Contains generation of performance plots, and analysis of time/performance trade-off. |
| [erllm.discarding_selective_matcher](#package-erllmdiscarding_selective_matcher) | Explores the similarity-based discarding matcher.  Simulates a discarding matcher, evaluates its performance on multiple datasets  with different threshold values, generates performance plots, and analyzes trade-off metrics based on F1 decrease thresholds. |
| [erllm.ditto](#package-erllmditto) |  |
| [erllm.llm_matcher](#package-erllmllm_matcher) | Contains code to create prompts from datasets and get responses via OpenAI's API. |
| [erllm.selective_classifier](#package-erllmselective_classifier) | Explores selective classification. |
| [erllm.selective_matcher](#package-erllmselective_matcher) | Explores selective classification. |

## Package: erllm

| Module | Purpose |
| --- | --- |
| [erllm_setup.py](erllm/erllm_setup.py) | Add .pth file to the site-packages directory of the current Python interpreter to make erllm discoverable. |
| [gen_docs.py](erllm/gen_docs.py) | Generate a package overview table and a table for each package's subfiles in a markdown file. |
| [utils.py](erllm/utils.py) | Utility functions for various tasks including file operations, mathematical calculations, and data manipulation. |

## Package: erllm.calibration

| Module | Purpose |
| --- | --- |
| [calibration_plots.py](erllm/calibration/calibration_plots.py) | Performs calibration analysis on language model predictions for different datasets. Calculating Brier Score and Expected Calibration Error (ECE). |
| [confidence_hist.py](erllm/calibration/confidence_hist.py) | Generate histograms of confidence scores per outcome (TP, TN, FP, FN). |
| [reliability_diagrams.py](erllm/calibration/reliability_diagrams.py) | Third party code from https://github.com/hollance/reliability-diagrams with some small changes. Calibration computation and visualization using reliability diagrams. |

## Package: erllm.dataset

| Module | Purpose |
| --- | --- |
| [entity.py](erllm/dataset/entity.py) | Contains Entity and OrderedEntity classes to represent entities and serialize them into strings for use in prompts. |
| [load_ds.py](erllm/dataset/load_ds.py) | Provides functions for loading benchmark data from CSV files into pandas DataFrames or lists of tuples representing entity pairs. |
| [sample_ds.py](erllm/dataset/sample_ds.py) | Provides a function for sampling elements from a dataset while preserving the label ratio. |
| [stats_ds.py](erllm/dataset/stats_ds.py) | This module provides functions to compute dataset statistics like the number of pairs. |

## Package: erllm.dataset.dbpedia

| Module | Purpose |
| --- | --- |
| [access_dbpedia.py](erllm/dataset/dbpedia/access_dbpedia.py) | Access the DBPedia SQLite database after it has been created by load_dbpedia.py. |
| [load_dbpedia.py](erllm/dataset/dbpedia/load_dbpedia.py) | Loads data from .txt file and loads it into SQLite tables.  The primary tables store DBpedia entities with key-value pairs, and an additional table stores matching pairs. |
| [sample_dbpedia.py](erllm/dataset/dbpedia/sample_dbpedia.py) | Provides functions for generating a sample dataset of entity pairs from the DBPedia database. The dataset includes both matching and non-matching pairs of entities. The matching pairs are generated based on known matches, non-matching pairs are generated by token blocking on random entities. |
| [token_blocking.py](erllm/dataset/dbpedia/token_blocking.py) | Provides functions for token blocking and clean token blocking in entity resolution tasks. |

## Package: erllm.dataset.ditto

| Module | Purpose |
| --- | --- |
| [to_ditto.py](erllm/dataset/ditto/to_ditto.py) | Provides functions for converting labeled pairs of entities to Ditto format and split them into train, validation, and test sets. |
| [to_ditto_runner.py](erllm/dataset/ditto/to_ditto_runner.py) | Generates Ditto datasets from existing datasets. |

## Package: erllm.discarder

| Module | Purpose |
| --- | --- |
| [discarder.py](erllm/discarder/discarder.py) | This module provides functions for computing set-based and embedding-based similarities for pairs of entities within a given dataset.  The set-based similarities include Jaccard, Overlap, Monge-Elkan, and Generalized Jaccard,  while embedding-based similarities use cosine and Euclidean distance metrics. Saves the results and computation time into similarity files which serve as cache for composite matchers including a discarder. |
| [discarder_eval.py](erllm/discarder/discarder_eval.py) | Computes various functions from similarity files, such as the number of false negatives as function of the number of discarded pairs. |
| [discarder_vis.py](erllm/discarder/discarder_vis.py) | Generates plots to visualize evaluation discarder statistitcs.  It includes functions to plot specific relations for a given dataset and generate combined plots for multiple datasets,  offering insights into various metrics such as false negatives, risk, false negative rate, and coverage. |

## Package: erllm.discarding_matcher

| Module | Purpose |
| --- | --- |
| [discarding_matcher.py](erllm/discarding_matcher/discarding_matcher.py) | This module provides functions for evaluating the performance of a discarding matcher utilizing run and similarity files. It calculates classification, cost and duration metrics. |
| [discarding_matcher_duration_cmp.py](erllm/discarding_matcher/discarding_matcher_duration_cmp.py) | Calculates speedup factor of discarding matcher over LLM matcher. |
| [discarding_matcher_runner.py](erllm/discarding_matcher/discarding_matcher_runner.py) | Runs the discarding matcher algorithm on multiple datasets with different threshold values. It calculates various performance metrics such as accuracy, precision, recall, F1 score, cost, and duration. |
| [discarding_matcher_tradeoff.py](erllm/discarding_matcher/discarding_matcher_tradeoff.py) | Generate and analyze performance/cost trade-off for the discarding matcher based on F1 decrease thresholds. Calculates F1 decrease, relative cost, and relative duration for each dataset and threshold. |
| [discarding_matcher_vis.py](erllm/discarding_matcher/discarding_matcher_vis.py) | Generates performance comparison plots for the discarding matcher. |

## Package: erllm.discarding_selective_matcher

| Module | Purpose |
| --- | --- |
| [discarding_selective_matcher.py](erllm/discarding_selective_matcher/discarding_selective_matcher.py) |  |
| [discarding_selective_matcher_allstats_table.py](erllm/discarding_selective_matcher/discarding_selective_matcher_allstats_table.py) |  |
| [discarding_selective_matcher_contour.py](erllm/discarding_selective_matcher/discarding_selective_matcher_contour.py) |  |
| [discarding_selective_matcher_eval.py](erllm/discarding_selective_matcher/discarding_selective_matcher_eval.py) |  |
| [discarding_selective_matcher_metric_table.py](erllm/discarding_selective_matcher/discarding_selective_matcher_metric_table.py) |  |
| [discarding_selective_matcher_runner.py](erllm/discarding_selective_matcher/discarding_selective_matcher_runner.py) |  |

## Package: erllm.ditto

| Module | Purpose |
| --- | --- |
| [add_to_ditto_configs.py](erllm/ditto/add_to_ditto_configs.py) |  |
| [ditto_combine_predictions.py](erllm/ditto/ditto_combine_predictions.py) | Based on the stats of train and valid set and the results of running ditto, calculate the precision, recall, and F1 score for the total dataset. |
| [sm_ditto_comparison.py](erllm/ditto/sm_ditto_comparison.py) |  |

## Package: erllm.llm_matcher

| Module | Purpose |
| --- | --- |
| [cost.py](erllm/llm_matcher/cost.py) |  |
| [evalrun.py](erllm/llm_matcher/evalrun.py) | Methods for reading run files, deriving classification decisions, and calculating classification and calibration metrics |
| [gpt.py](erllm/llm_matcher/gpt.py) |  |
| [gpt_chat.py](erllm/llm_matcher/gpt_chat.py) |  |
| [llm_matcher.py](erllm/llm_matcher/llm_matcher.py) | Provides functions to evaluate the performance of the LLM Mathcer on a set of run files produced by the OpenAI GPT API.  It calculates various classification metrics, entropies, and calibration results.  The evaluation results are saved as JSON files for individual runs and aggregated into a CSV file for further analysis. |
| [prompt_data.py](erllm/llm_matcher/prompt_data.py) |  |
| [prompts.py](erllm/llm_matcher/prompts.py) |  |

## Package: erllm.selective_classifier

| Module | Purpose |
| --- | --- |
| [selective_classifier.py](erllm/selective_classifier/selective_classifier.py) |  |
| [selective_classifier_runner.py](erllm/selective_classifier/selective_classifier_runner.py) | This script runs the discarding matcher algorithm on multiple datasets with different threshold values. It calculates various performance metrics such as accuracy, precision, recall, F1 score, cost, and duration. The results are stored in a pandas DataFrame and saved as a CSV file. |
| [selective_classifier_tab.py](erllm/selective_classifier/selective_classifier_tab.py) | This script generates performance comparison plots for the discarding matcher. It reads performance metrics from a CSV file, filters the data based on selected metrics, and creates line plots for each dataset with different configurations, such as all metrics, no cost, and F1 with cost. It also creates plots with showing the performance on all datasets at once. |
| [selective_classifier_vis.py](erllm/selective_classifier/selective_classifier_vis.py) | This script generates performance comparison plots for the discarding matcher. It reads performance metrics from a CSV file, filters the data based on selected metrics, and creates line plots for each dataset with different configurations, such as all metrics, no cost, and F1 with cost. It also creates plots with showing the performance on all datasets at once. |

## Package: erllm.selective_matcher

| Module | Purpose |
| --- | --- |
| [random_table.py](erllm/selective_matcher/random_table.py) | This script generates performance comparison plots for the discarding matcher. It reads performance metrics from a CSV file, filters the data based on selected metrics, and creates line plots for each dataset with different configurations, such as all metrics, no cost, and F1 with cost. It also creates plots with showing the performance on all datasets at once. |
| [random_table_with_sd.py](erllm/selective_matcher/random_table_with_sd.py) | This script generates performance comparison plots for the discarding matcher. It reads performance metrics from a CSV file, filters the data based on selected metrics, and creates line plots for each dataset with different configurations, such as all metrics, no cost, and F1 with cost. It also creates plots with showing the performance on all datasets at once. |
| [selective_matcher.py](erllm/selective_matcher/selective_matcher.py) | Defines functions to manually label predictions by selecting the k most uncertain,  k most uncertain negative, and k random predictions from a given set. It applies these labeling strategies to predictions on different datasets,  calculates various classification metrics, and saves the results for comparison. |
| [selective_matcher_runner.py](erllm/selective_matcher/selective_matcher_runner.py) | This script runs the discarding matcher algorithm on multiple datasets with different threshold values. It calculates various performance metrics such as accuracy, precision, recall, F1 score, cost, and duration. The results are stored in a pandas DataFrame and saved as a CSV file. |
| [selective_matcher_vs_base_table.py](erllm/selective_matcher/selective_matcher_vs_base_table.py) | This script generates performance comparison plots for the discarding matcher. It reads performance metrics from a CSV file, filters the data based on selected metrics, and creates line plots for each dataset with different configurations, such as all metrics, no cost, and F1 with cost. It also creates plots with showing the performance on all datasets at once. |
